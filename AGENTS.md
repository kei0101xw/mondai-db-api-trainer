# AGENTS.md

## 1. プロジェクト概要

### プロダクト名

* **mondAI**

### コンセプト

* バックエンドエンジニア（特に経験が浅い人）向けの
  * **データベース設計**
  * **API設計**
* に特化した「設計問題練習用 Web アプリ」です。
* SNSアプリなど、現実的な題材を元に
  * 問題を生成し
  * 回答を書き
  * AIで採点と解説を返す
    という流れを繰り返すことで、設計の引き出しを増やすことを目標とします。

### 想定ユーザー

* Webバックエンド初学者
* 就活の面接で「DB設計・API設計」の問題対策をしたいエンジニア学生
* 自分の設計力を定期的にチェックしたい初〜中級エンジニア

---

## 2. 審査観点とプロダクトのゴール

本プロジェクトは「技育ハッカソン」に出場するためのものです。
審査は **オーディエンス投票方式** で行われ、主に以下の観点が見られます。

### 2.1 審査基準（要約）

1. **サービスとしての価値**
   * 世の中の役に立つか
   * 面白い・触っていて楽しいか
2. **サービスの完成度**
   * 実装されている機能が一通り使えるか
   * UI / UX が直感的でストレスなく操作できるか
3. **技術的な挑戦**
   * 新しい / 難しい技術にチャレンジしているか
   * 設計や実装に工夫が見られるか

### 2.2 mondAI として目指す方向

* **価値**
  * 「DB・API設計」という抽象的になりがちなテーマを、**具体的な問題演習**として体験できること
  * 面接対策としてもそのまま使えるような、現実に近い題材の問題を用意すること
* **完成度**
  * ゲストでもワンクリックで問題を解いて遊べる
  * ログインユーザーは自分の回答・スコアを蓄積できる（データとして）
* **技術的な挑戦**
  * 問題生成と採点・解説に AI を活用する
  * DB スキーマ・API 設計自体も「ちゃんとした設計」を目指す

---

## 3. 開発スタック・構成方針

### 3.1 技術スタック

* **バックエンド**
  * Python / Django
  * Django REST Framework（DRF）で JSON API を提供
  * パッケージ管理：`uv`
  * Lint・Format：`Ruff`
* **データベース**
  * **PostgreSQL**（開発・本番ともに Postgres 前提）
* **フロントエンド**
  * React
  * TypeScript
  * Lint：`ESLint`
  * Format：`Prettier`

### 3.2 リポジトリ構成（モノレポ）

* `backend/`
  * Django プロジェクト・アプリケーション
  * DRF を用いた API 実装
* `frontend/`
  * React + TypeScript の SPA
  * バックエンドの REST API を叩くクライアント

---

## 4. MVP（ハッカソンで必ず実装する範囲）

MVP の目標は、

> 「ユーザー（またはゲスト）が 1 問生成して解き、採点と解説を見られる」

という一連の流れを、ストレスなく体験できるようにすることです。

### 4.1 認証・ゲスト

#### ログインユーザー

* メールアドレス＋パスワードによる
  * ユーザー登録
  * ログイン
  * ログアウト
* ログインユーザーの「生成した問題」「回答」「採点結果」は **DB に永続保存**する。

#### ゲストモード

* 会員登録なしで、「すぐに問題を 1 問解いてみる」ことができる。一問解いた後は新規登録を求めて、これ以上問題解けないようにする。
* ゲストユーザーの「問題」「回答」「採点結果」は **永続保存しない**（セッションまたは一時的な状態としてのみ保持）。
* ゲストとログインユーザーの両方で、同じ UI の流れを辿れることが望ましい。

### 4.2 問題生成

ユーザー（ログイン or ゲスト）は、以下を指定して問題を生成する：

* **難易度**
  * `easy | medium | hard`
* **問題（サービス）規模**
  * `small | medium | large`
* **モード**
  * `db_only`：DB設計問題だけ
  * `api_only`：API設計問題だけ
  * `both`：DB・API両方の設計問題

AI により、以下のような構造の問題を生成する：

* アプリの概要説明（例：SNSアプリ、ECサイトなど）
* 設計問題パート
  * DB 設計問題（必要テーブル・カラム・制約などを SQL ライクに記述させる）
  * API 設計問題（擬似コードで API を実装させる）
* モードに応じて、DB / API どちらを含めるかが変わる。

**ログインユーザーの場合：**

* 生成された問題は `Problem` レコードとして DB に保存する。

**ゲストユーザーの場合：**

* 問題は DB に保存せず、その場限りの一時データとして扱う。

### 4.3 問題回答

問題に対して、ユーザーは以下のように回答する：

* `db_only` モード
  * DB設計回答（SQLライクなDDL）を入力するテキストエリア
* `api_only` モード
  * API設計回答（擬似コード）を入力するテキストエリア
* `both` モード
  * 上記 2 つの入力欄を両方表示

**ログインユーザーの場合：**

* 回答は `Answer`（または同等のモデル）として DB に保存する。
* 後の復習や分析に使えるよう、問題との紐付けも保存しておく。

**ゲストユーザーの場合：**

* 回答は永続保存せず、その場の画面表示のためだけに持つ。

### 4.4 採点・解説

AI による自動採点と解説表示を行う。

* 採点は、マルバツサンカクで行う。
* 採点と同時に、模範解答（DB設計例・API擬似コード例）と解説テキストを表示する。
* ログインユーザーの場合：
  * スコア・模範解答・解説は `Answer` レコード等に紐づけて保存しておく。
* ゲストユーザーの場合：
  * スコア等は永続保存せず、その問題画面でのみ表示。

---

## 5. 追加機能（MVP外）

ここに記載する機能は、「時間があれば実装したいが MVP ではない」ものです。

### 5.1 優先度 High の追加機能

* **ユーザープロフィール**
  * 表示名・アイコン・自己紹介などを登録・編集できる画面
* **復習画面（マイ問題一覧）**
  * ログインユーザーが過去に解いた問題の一覧
  * 各問題ごとに「問題文」「自分の回答」「スコア」「模範解答・解説」を確認できる。
  * 難易度や解いた日時でソート／簡易フィルタ（タグではなく難易度などで絞り込む）。
* **問題の再挑戦機能**
  * 過去の問題に対して、再度回答を送ることができる。
  * 再回答をどのように保存するか（複数回答履歴を持つか）は別途設計。
* **問題評価**
  * ユーザーが問題に対して評価（例：5段階評価・Likeボタンなど）を付ける。
  * 評価は後のプロンプト改善や「みんなの問題」表示条件に利用する。

### 5.2 優先度 Medium の追加機能

* **みんなの問題**
  * 他のユーザーが生成し、かつ高評価した問題の一覧ページ。
  * 自分で生成した問題と同様に解答できる。
* **ステータス画面**
  * ユーザーごとの
    * 解いた問題数
    * 平均スコア
    * 難易度ごとのスコア傾向
      などを可視化する。
* **ランキング**
  * 総スコアや解答数などに基づく簡易ランキング。
  * ハッカソンの演出として、トップページなどから見える形が望ましい。
* **採点結果の手動修正・再採点**
  * AI 採点が明らかにおかしい場合に、ユーザーが手動でスコアを修正できる。
  * 修正履歴を保存し、AI 採点とユーザー修正との差分を後で分析できるようにする。

### 5.3 優先度 Low の追加機能

* **ゲストから本登録への引き継ぎ**
  * ゲストで解いた問題・回答を、後からユーザー登録した際に引き継ぐ。
* **より細かいフィルタ・検索**
  * 難易度・スコアレンジ・作成日時などによる絞り込み。

---

## 6. ドメインモデルの前提（概念レベル）

厳密な DB スキーマは別途設計しますが、AI がコードを生成する際に前提とする概念モデルはおおよそ以下の通りです。

* `User`
  * ログインユーザーを表す。
  * ゲストユーザーは DB 上には保存しない（MVP）。
* `Problem`
  * 生成された設計問題を表す。
  * ログインユーザーが生成した問題のみ永続保存する。
  * 主な属性（例）：
    * 題材説明（アプリの概要）
    * 難易度
    * モード（`db_only` / `api_only` / `both`）
    * 問題文（設問）
    * 作成ユーザー（外部キー）
* `Answer`
  * ユーザーが特定の `Problem` に対して行った回答を表す。
  * 主な属性（例）：
    * DB設計回答テキスト
    * API設計回答テキスト
    * 採点結果（数値スコア）
    * 模範解答・解説（AI生成結果のスナップショット）
    * 回答日時

実際のモデル設計・フィールド名は、この前提をベースに Django モデルとして具体化します。

---

## 7. API 設計方針（概要）

* API は **RESTful な JSON API** とします。
* パスは `/api/v1/...` をベースにします。
  * 認証系：`/api/v1/auth/...`
  * 問題生成・取得：`/api/v1/problems/...`
  * 回答投稿・採点：`/api/v1/answers/...` など
* レスポンスは基本的に
  * `data`（メインのデータ）
  * `error`（エラー時の情報）
    のようなシンプルな構造を保つことを目指します。
* バックエンドは Django REST Framework（DRF）を用いて実装します。

---

## 8. フロントエンド方針（概要）

* React + TypeScript による SPA とします。
* 想定されるメイン画面（MVP 時点）：
  * トップ／問題生成画面
    * 難易度・モード選択 → 「問題を生成」ボタン
  * 問題解答画面
    * 問題文表示
    * DB設計／API設計の回答フォーム
  * 採点結果画面
    * スコア
    * 模範解答
    * 解説
* ログイン／ゲストは、同じ UI フローで扱います（見た目はほぼ同じ）。
* API との通信は
  * 専用の API クライアントモジュールを作成し、
  * コンポーネントから直接 `fetch` を呼ばない。
    例：`src/api/client.ts` に共通クライアント、`src/api/problems.ts` や `src/api/answers.ts` にドメインごとの関数をまとめる。

---

## 9. コーディング規約

### 9.1 Python / Django

* **スタイル**
  * PEP8 準拠
  * 可能な限り、すべての関数・メソッドに型ヒントを付与する。
* **フレームワークの使い方**
  * Web API は Django REST Framework（DRF）を使用する。
  * HTML テンプレートレンダリングは行わず、JSON API のみにする。
  * ビジネスロジックは View から切り出し、サービス層やユースケース関数にまとめることを優先する。
* **命名・設計**
  * モデル名・フィールド名・変数名は英語。
  * DB テーブル・カラムもモデルに合わせて英語で統一する。
  * 設定値（シークレット・DB 接続情報など）は環境変数から読み込む。

### 9.2 TypeScript / React

* **スタイル**
  * 関数コンポーネント＋Hooks を使用する（クラスコンポーネントは使用しない）。
  * `any` の使用は原則禁止。
    * やむを得ず使用する場合は `// TODO: 型を絞る` コメントを付ける。
  * ESLint / Prettier が通るコードのみをコミットする。
* **構成**
  * コンポーネントは「表示のみ」と「データ取得 / 状態管理」をできるだけ分離する。
  * API クライアント・型定義は `src/api/` や `src/types/` などに集約し、
    コンポーネントから直接 `fetch` を呼ばない。
* **命名**
  * コンポーネント名・型名・インターフェース名は `PascalCase`。
  * ファイル名は `kebab-case` または `camelCase` に統一する（プロジェクト内の既存方針に合わせる）。

### 9.3 共通（Python / TypeScript）

* 既存関数・クラスのシグネチャや挙動を変更する場合は、
  * なぜ変更が必要なのかをコメントまたは Docstring に残してから変更する。
* コメントは「何をしているか」よりも「なぜそうしているか」を優先して書く。
* Conventional Commits(config-conventional)に準じたコミットメッセージ、かつ、フロントエンド・バックエンドともにリンタ・フォーマッタのチェックを満たさないと、コミットできないような設定にしています。

---

## 10. このファイルの使い方

* このファイルに書かれているのは、**mondAI プロジェクトの前提・設計方針・MVPと追加機能の境界**です。
* **MVP セクションに書かれているものを最優先**で実装してください。
* 追加機能は、明示的に指示があった場合にのみ着手する想定です。
